import pandas as pd, pylab as py, numpy as np, tables as t
import matplotlib.dates as mdates
from statistics import mean
from scipy.optimize import curve_fit

# making albedo correction with the fill 7920 or 7921. 2 single bunches.
# currently makes correction for both old and new channel mask

# ---------- READ IN and INPUTS-------------

# folder_reprocessed should be a fill with original channel mask, reprocessed with NO albedo correction 
folder_reprocessed = '/localdata/lfreitag/22/7921/'
# folder_reprocessed_newChannels should be a fill with new channel mask, reprocessed with NO albedo correction
folder_reprocessed_newChannels = '/localdata/lfreitag/newChannels/22/7921/'

files = ['7921_355131_2207060104_2207060104.hd5','7921_355132_2207060104_2207060213.hd5','7921_355133_2207060213_2207060419.hd5','7921_355134_2207060419_2207060518.hd5','7921_355135_2207060518_2207061215.hd5']

bxraw_reprocessed = []
for file in files:
	h5 = t.open_file(folder_reprocessed+file)
	for row in h5.root.bcm1flumi.iterrows():
		bxraw_reprocessed.append(row['bxraw'])
	h5.close()

bxraw_reprocessed_newChannels = []	
for file in files:
	h5 = t.open_file(folder_reprocessed_newChannels+file)
	for row in h5.root.bcm1flumi.iterrows():
		bxraw_reprocessed_newChannels.append(row['bxraw'])
	h5.close()	


bxraw_reprocessed_tot_orig_channel = [sum(x) for x in zip(*bxraw_reprocessed)]
bxraw_reprocessed_tot = [sum(x) for x in zip(*bxraw_reprocessed_newChannels)]

# some existing albedo models to compare new model to
# Moritz's tuned original albedo model
albedo_model_moritz = [1.0,1.95e-02,2.7e-03,1.13e-03,3.034200308152319768e-04,2.221646663094018143e-04,1.888584507229004088e-04,1.790465401076311251e-04,1.755315402643227104e-04,1.716421814353780682e-04,1.693231423216642515e-04,1.664825576675592626e-04,1.634739601206776491e-04,1.610602695339022838e-04,1.588614441821578204e-04,1.568547673423986602e-04,1.545830575537533963e-04,1.524424465758141445e-04,1.501172587599649113e-04,1.482099695907348254e-04,1.465426308648851736e-04,1.441208951346728421e-04,1.426930324631596806e-04,1.408453782327286226e-04,1.389238929899552809e-04,1.371216721558548234e-04,1.348305608050969764e-04,1.337268905471925484e-04,1.320193238521213193e-04,1.303874843637422675e-04,1.283689805733012016e-04,1.267125267545334271e-04,1.250485043327773354e-04,1.242250111375709518e-04,1.226182516116503625e-04,1.205197675729901017e-04,1.193190771962571590e-04,1.174808897885385242e-04,1.166133818466571343e-04,1.150468545331585855e-04,1.140548762951357681e-04,1.120060846689353943e-04,1.101328768568840809e-04,1.092932935674779021e-04,1.085999512756999439e-04,1.069842024753895541e-04,1.055568166685093382e-04,1.042259788834365880e-04,1.029845884016596054e-04,1.016528035245090506e-04,1.006276972955876686e-04,9.951361762829919280e-05,9.864469205337387614e-05,9.727930544650062710e-05,9.606631215865893219e-05,9.437768177883077325e-05,9.380786376970672567e-05,9.251820161040493612e-05,9.114571591549365829e-05,9.030092748021457743e-05,8.929996034922572045e-05,8.828195471663599289e-05,8.699891836935114327e-05,8.598848541863663287e-05,8.489570284196662616e-05,8.407079287712166456e-05,8.323783672268270637e-05,8.220137364101346865e-05,8.155110138478779145e-05,8.033668870339937484e-05,7.911659678550956611e-05,7.834563992637795645e-05,7.726942355954023300e-05,7.666884331146970634e-05,7.544827900406729960e-05,7.455095884237988022e-05,7.379230650002441760e-05,7.259587922097337576e-05,7.226458941614773677e-05,7.130337811070883137e-05,7.046095799767889279e-05,6.947844918776454064e-05,6.898861417087448782e-05,6.813388909388959564e-05,6.679500683107574411e-05,6.626825821483716317e-05,6.536289244143013834e-05,6.482383851380107672e-05,6.408411712594841729e-05,6.336143441408083072e-05,6.259757614656617612e-05,6.179207102544063610e-05,6.105897609723299948e-05,6.050430346141162749e-05,5.984267276506068892e-05,5.892594874183299582e-05,5.831874362482706605e-05,5.749336133711316425e-05,5.720939963659271954e-05,5.637644503124811701e-05,5.548291139458284501e-05,5.539724996223892111e-05,5.440291016577796250e-05,5.379901868415810700e-05,5.303658091129118921e-05,5.236548460936281543e-05,5.173934901309727930e-05,5.130630767410091810e-05,5.101950617224489327e-05,5.045536874463897359e-05,4.948469329111902191e-05,4.887322882869020636e-05,4.851307058491011041e-05,4.777713663243170753e-05,4.738952946009238987e-05,4.650782923387691809e-05,4.626740787662217576e-05,4.560577722581105558e-05,4.496970330812380536e-05,4.465687195751184417e-05,4.396116611020802818e-05,4.357734429610884128e-05,4.278793101672741218e-05,4.261802766621127230e-05,4.216037624284053577e-05,4.151815001285791431e-05,4.087545008944288633e-05,4.069608105907869094e-05,4.013809665737341737e-05,3.983520465108897004e-05,3.925923565417484208e-05,3.859429253253821528e-05,3.826915686197098561e-05,3.791657141565578712e-05,3.734864849489340048e-05,3.703913018379933049e-05,3.658289895369897914e-05,3.615742985324953867e-05,3.580673764208450139e-05,3.533536156731362552e-05,3.485357380320578270e-05,3.445602768647482714e-05,3.417774535463233862e-05,3.357906053295481330e-05,3.308591410502122253e-05,3.286537039944648411e-05,3.251704469315856450e-05,3.205702730191033396e-05,3.202295208631313528e-05,3.149998963973800134e-05,3.117911337361030534e-05,3.070158502201327829e-05,3.060219841415401962e-05,3.025150587132580506e-05,2.982556419128131294e-05,2.930402200424996696e-05,2.881986797533020347e-05,2.873562608240852755e-05,2.823964050210028994e-05,2.792065724512676525e-05,2.770721273436797086e-05,2.737497839983840734e-05,2.722637189165615207e-05,2.651552195305111926e-05,2.645068429428170607e-05,2.627131544252246119e-05,2.591447103346696088e-05,2.556661807582679877e-05,2.524810823601077379e-05,2.516244670866263841e-05,2.488274482081104184e-05,2.455145655360224525e-05,2.412362160515982079e-05,2.377387623223435422e-05,2.362006399726880926e-05,2.324144889872236248e-05,2.280556855493000309e-05,2.250078352571836107e-05,2.273505146535595865e-05,2.245913568837331760e-05,2.196740975434697388e-05,2.169480702347253677e-05,2.141794485031979498e-05,2.115338756670328445e-05,2.085522826901787724e-05,2.081026782289499110e-05,2.062853266130234051e-05,2.017135527554137791e-05,2.012497491975380912e-05,1.972364317287668656e-05,1.955515948744308006e-05,1.949174156684205524e-05,1.911170697411699177e-05,1.916849908773637584e-05,1.859631749398541354e-05,1.857596676436402240e-05,1.819545872767590561e-05,1.808897357062947295e-05,1.811878946605432591e-05,1.772786964243333688e-05,1.738948250659218866e-05,1.744816787609530478e-05,1.714385629891800495e-05,1.689586356489263959e-05,1.683055252376851817e-05,1.651204272142102610e-05,1.632510183822848024e-05,1.628771356623032966e-05,1.591714425489841847e-05,1.561519910647639160e-05,1.560715355258864164e-05,1.530852122413074034e-05,1.512299990524073255e-05,1.490387661189776737e-05,1.484803089578135478e-05,1.468617316150179634e-05,1.462228200264441620e-05,1.430755838380744892e-05,1.414759387423721019e-05,1.403826861751383549e-05,1.395639319696199247e-05,1.370934706755322171e-05,1.355127555403057472e-05,1.341497420603177572e-05,1.334303735111355117e-05,1.312438747248448543e-05,1.295590384110627699e-05,1.285131159924648779e-05,1.287260876132173543e-05,1.240785903445669865e-05,1.226209244468068669e-05,1.238182938111472250e-05,1.199942856608156537e-05,1.202403844186136008e-05,1.191707971970854943e-05,1.165867532441059724e-05,1.153089285778432946e-05,1.143150658906714750e-05,1.123273383444856891e-05,1.123935964927934889e-05,1.106567013220979594e-05,1.089813313217968471e-05,1.080395282971860169e-05,1.067664359712792405e-05,1.050342733268013414e-05,1.046935214996045832e-05,1.035482107567034765e-05,1.023887035555031525e-05,1.001880062116386459e-05,1.013475137319879571e-05,9.889598522406644080e-06,9.741938605067963406e-06,9.687512790026611253e-06,9.580080829765542233e-06,9.420589492770650543e-06,9.182062302566280045e-06,9.292333853569035716e-06,9.002220414258757248e-06,9.063745262764394937e-06,8.814332910603243091e-06,8.738609983839614600e-06,8.695542522434902176e-06,8.455122372985039177e-06,8.442817237385680818e-06,8.316454651397089731e-06,8.339171627244228630e-06,8.269127941498959772e-06,7.979961022019756300e-06,8.008357091824958151e-06,7.909917213798288676e-06,7.890039996042416532e-06,7.827095424548332191e-06,7.744273336438682134e-06,7.601346415081220177e-06,7.494860979982717492e-06,7.431916328220072594e-06,7.307446886005805297e-06,7.232670469150755493e-06,7.163100029659078108e-06,7.083117672168705821e-06,7.019226447037929683e-06,6.916054052938289234e-06,6.930252018346383711e-06,6.813828145570047896e-06,6.692671491182862896e-06,6.627360370752810153e-06,6.528920741010719237e-06,6.568675104917574488e-06,6.349552034534604437e-06,6.192426979975175403e-06,6.250165719907359214e-06,6.179175473826491898e-06,6.163557649032635920e-06,6.003119746666849150e-06,5.897580848652718572e-06,5.897107587145138604e-06,5.784943085708659732e-06,5.754180593886596281e-06,5.749921283562692472e-06,5.581911022173098212e-06,5.521332638036219125e-06,5.474479137367437681e-06,5.474952426717248970e-06,5.427152364676190526e-06,5.333445310986346869e-06,5.210868803063231823e-06,5.131833008203961326e-06,5.081193336390755057e-06,5.080246838774226175e-06,4.969028767718249258e-06,4.986066393399561493e-06,4.844559215912220738e-06,4.809064164476674000e-06,4.753691767773760577e-06,4.695953014660945355e-06,4.705418413791194488e-06,4.665190628506074362e-06,4.525103334692398307e-06,4.614077680893929704e-06,4.467364562104830260e-06,4.400633783552805992e-06,4.351887124300003066e-06,4.407259521965546564e-06,4.302194071987135859e-06,4.230257277048185903e-06,4.172518565254427282e-06,4.015866780570057560e-06,4.048049021075392586e-06,4.085910482235751966e-06,4.075498579861289589e-06,3.904648808516907658e-06,3.977532079154034252e-06,3.996462753753556583e-06,3.827979371622557620e-06,3.715814819240718859e-06,3.709662307162526132e-06,3.645297842220377715e-06,3.661388994869258134e-06,3.651450347560157378e-06,3.494325304256098759e-06,3.574307628646796007e-06,3.443212385448815497e-06,3.478707496641491425e-06,3.371275609170085225e-06,3.330101313235902586e-06,3.313536883825452857e-06,3.216516920202570474e-06,3.260057641485796586e-06,3.231188254932843774e-06,3.220776371292648702e-06,3.034782047547118838e-06,3.167297116068555736e-06,3.066964252361083317e-06,2.986982003870085362e-06,2.973730423821012028e-06,2.995027547094851803e-06,2.869611472125565988e-06,2.848787648198083127e-06,2.878130299220555869e-06,2.826544103873850392e-06,2.783949934928984883e-06,2.834589650949137979e-06,2.714379558304472738e-06,2.753187500790693116e-06,2.620672452188299422e-06,2.595589223154849221e-06,2.635817005848272145e-06,2.628244707025885072e-06,2.570032748830437197e-06,2.464493976994929173e-06,2.436097907115679277e-06,2.546842642689637082e-06,2.440830625489119192e-06,2.442250379207688661e-06,2.408175084970990200e-06,2.374573051501387459e-06,2.331978937352402562e-06,2.245370920384977848e-06,2.301689805892650006e-06,2.283232271064993550e-06,2.220760939752525094e-06,2.198044064611327957e-06,2.164442039064913332e-06,2.177693564910493792e-06,2.115695437866124849e-06,2.091085473524339555e-06,2.043758646037211789e-06,2.085879575689043443e-06,2.014889374185365713e-06,2.068841929422251798e-06,1.977501140248136633e-06,1.977027874223598890e-06,2.051804231321519080e-06,1.939639728255973505e-06,1.925914939125649014e-06,1.905091158072240144e-06,1.905091147557354826e-06,1.832207868626798202e-06,1.887106978571597538e-06,1.864863371454247183e-06,1.762637478895703960e-06,1.779201852547642156e-06,1.716730452221983558e-06,1.745599849882209850e-06,1.688334390339969823e-06,1.702532412395158288e-06,1.716730480360408749e-06,1.670823461461779529e-06,1.634855103275027456e-06,1.614031304005690552e-06,1.580429287345094543e-06,1.579482744855182205e-06,1.511805402487280670e-06,1.496187554071956852e-06,1.565757983641137504e-06,1.528843048309781088e-06,1.535468808122535057e-06,1.542567843438033122e-06,1.506599473699716764e-06,1.433242924301713090e-06,1.445074604756697023e-06,1.424250825924743019e-06,1.392541886913170881e-06,1.387335898590623187e-06,1.422831006747310686e-06,1.350894276008400074e-06,1.369351762630491200e-06,1.310193219219153931e-06,1.330543744392667617e-06,1.305933806338095408e-06,1.225005006545415392e-06,1.221218841917257806e-06,1.235890141252353581e-06,1.264286237937156256e-06,1.255767398920360178e-06,1.224531749554793199e-06,1.220272305055030676e-06,1.204654464414798040e-06,1.123252353057760621e-06,1.149755364392496285e-06,1.117573137289936802e-06,1.169632599475714009e-06,1.121832551503868160e-06,1.120886026489399183e-06,1.135084066982660660e-06,1.047529470056789000e-06,1.092963210638831519e-06,1.125618691325782854e-06,1.057941347402862659e-06,1.013927431848083082e-06,1.024339380428801748e-06,1.014873997218978162e-06,9.774858100063446418e-07,9.566619934096621594e-07,9.093351950976384429e-07,9.311055401150208790e-07,9.850581015719802275e-07,9.467233824583686857e-07,1.000675933696636585e-06,9.642342899365459000e-07,9.396243603975498639e-07,8.312459799006208117e-07,8.908777509053307159e-07,8.700539742948311536e-07,8.691074643122050589e-07,8.558559511289156801e-07,8.643747593415411099e-07,8.430776821258602667e-07,8.468638375720055810e-07,8.090023910732469583e-07,7.900716918896262898e-07,7.739805647874734357e-07,8.317192594760318788e-07,7.919647396971100124e-07,7.706676831409570465e-07,8.222538821900871579e-07,7.541033117104732924e-07,7.635686641901746976e-07,7.924380163105813294e-07,7.105626433719154748e-07,7.356458360475582885e-07,7.593092382025338658e-07,7.290200847503805980e-07,6.717546561604083650e-07,6.954180597963534997e-07,7.564696527923381291e-07,6.594496922794920073e-07,6.656021808102655742e-07,6.466714534882195036e-07,6.859527217561072378e-07,7.034636271609270506e-07,6.400457055232236878e-07,6.438318526018898698e-07,6.324734316551766529e-07,6.674952399471679673e-07,6.708081377362546708e-07,6.395724282433157417e-07,6.116496232038274773e-07,5.870397038094741058e-07,5.487049854363473427e-07,5.860931593943011959e-07,5.804139191904768210e-07,5.288277168091648350e-07,5.420792385820787478e-07,5.605366759619255790e-07,5.080039425682168610e-07,5.122633558935663995e-07,5.785208762701934214e-07,5.458653756641990940e-07,5.283544641874032700e-07,5.117900806129677053e-07,5.359267552346993730e-07,5.345069362053641861e-07,5.515446005399865063e-07,5.056375960808124304e-07,5.151029522629382585e-07,5.236217740264370127e-07,4.862336206539625696e-07,4.687226790394323033e-07,4.838672634295274185e-07,4.985385638753508382e-07,4.791345888187435255e-07,4.516850388446168816e-07,4.781880581765893416e-07,4.871801339687707508e-07,4.587840570549143459e-07,4.881266939341260251e-07,4.644632876324352213e-07,4.426929584614292304e-07,4.138236030088405122e-07,4.195028189247608423e-07,4.308612637150870885e-07,3.991522893083378492e-07,4.294414449078973034e-07,4.048315091488280040e-07,4.161899376484870013e-07,4.157166793249919733e-07,4.142968862866757904e-07,4.095641914606548237e-07,3.911067280897887768e-07,3.896869342369394538e-07,4.109839958283894653e-07,3.593977873010530008e-07,3.717027453321387492e-07,3.579779749360815634e-07,3.522987567246581123e-07,3.489858717459598484e-07,3.224828732216124121e-07,3.612908524358827260e-07,3.683898610198766908e-07,3.101779098590355371e-07,3.276888200029585264e-07,3.324215101639249956e-07,3.489858738933658231e-07,3.508789653154088449e-07,3.404670743444133946e-07,3.324215141625432876e-07,3.068650362097557320e-07,3.163303995005363250e-07,3.125442429436635780e-07,3.125442436100999953e-07,2.548055524018205733e-07,2.959798688474343664e-07,3.130175042290981443e-07,3.011858269581991513e-07,3.546651064701959503e-07,2.850946985231736743e-07,2.808352876414241914e-07,2.746828124393785469e-07,2.481797897752240004e-07,2.813085824708235420e-07,2.775224086606534714e-07,2.950333469430016512e-07,2.931402590012378622e-07,2.675837950436144344e-07,2.571718888186307006e-07,2.292490824462696016e-07,2.548055552156629652e-07,2.434471144239552228e-07,2.410807798583572010e-07,2.917204681103278657e-07,2.642709073991705014e-07,2.164708478017123245e-07,2.415540471417193112e-07,2.335084853307822888e-07,2.727897258304871690e-07,2.344550278947430932e-07,1.899678326164553028e-07,2.585916988140503380e-07,2.297223532099105211e-07,2.235698677151249598e-07,2.548055457374566121e-07,1.871282302491558998e-07,2.150510441744625674e-07,2.193104563150362059e-07,2.164708571318219549e-07,2.268827446965866397e-07,1.999064748902590129e-07,2.216767945830586506e-07,2.117381669708554857e-07,1.913876484617055495e-07,1.965936069427126708e-07,1.947005263317490485e-07,2.358748270790835428e-07,1.894945693317116964e-07,1.942272608255507884e-07,2.098450905066070900e-07,1.814490181837569272e-07,1.771895967871223374e-07,1.663044377922801040e-07,1.861816905730861665e-07,2.245163982832306764e-07,1.757697934560664494e-07,1.923341845093993273e-07,1.937539782141517157e-07,2.032193506869447928e-07,1.771896113006257363e-07,1.677242523046575162e-07,1.842886245496746222e-07,1.904411152278541637e-07,1.629915796931826633e-07,1.516331380128931017e-07,1.544727399359014892e-07,1.431143089185939691e-07,1.705638513397750444e-07,1.450073680554963621e-07,1.118786183820681698e-07,1.861817024948927870e-07,1.610984943431158644e-07,1.696173090720081091e-07,1.535262024812864096e-07,1.544727537089202153e-07,1.653578905632645903e-07,1.667776984112782530e-07,1.260766613929783806e-07,1.596786911601569110e-07,1.364885556221070267e-07,1.331756719762815973e-07,1.388548900396081139e-07,1.767163413515181687e-07,1.686707790222418753e-07,1.483202556999402952e-07,1.327024086915377792e-07,1.218172445133013538e-07,1.610984976752977391e-07,1.208707139451956372e-07,1.587321716993242513e-07,1.279697375610326954e-07,1.137716960310922538e-07,1.222905124630998813e-07,1.398014259392049571e-07,1.719836571884794552e-07,1.402747040336460433e-07,1.123518909969211948e-07,1.151914994361966090e-07,1.431143149165215130e-07,1.005201861059362824e-07,1.279697225291898138e-07,1.189776361480746187e-07,1.189776436269717200e-07,1.033597858074902279e-07,1.412212277892908641e-07,1.180311049135324848e-07,1.033597991362179386e-07,1.151914967704509398e-07,1.237103264571378107e-07,1.265499166804854030e-07,8.774195879217938374e-08,1.270231879624655934e-07,1.166113030634463660e-07,1.312826061750152431e-07,6.881123346944245912e-08,6.502509720185535898e-08,9.152809106114808598e-08,9.342117352332402557e-08,9.578751193944319307e-08,9.484097085645236960e-08,1.473737246134950959e-07,1.535262132923655974e-07,9.294790090847078879e-08,9.294789357767062205e-08,8.537560838020512843e-08,9.910038025723187162e-08,9.342116286034177236e-08,6.123895426990450940e-08,7.543699542960250877e-08,1.180311122443326516e-07,6.549835315579879865e-08,9.436770342499332486e-08,7.969640097986065333e-08,1.114053424350330583e-07,9.389443880737688386e-08,9.957363554473889399e-08,7.733007137551142172e-08,7.733005323363206721e-08,1.038330710846347581e-07,9.436770423952667672e-08,8.395581430521019184e-08,1.360152871539692282e-07,7.070430208455120534e-08,7.023104531607441381e-08,8.348254413395722240e-08,9.484096537686430843e-08,8.490234442902489298e-08,5.603300415637630856e-08,8.537560571445945925e-08,1.194508982480425368e-07,9.247464384380012813e-08,9.626077522418701124e-08,6.786469756984561593e-08,5.981914308970897200e-08,7.827658913322891040e-08,9.436769209557465435e-08,4.183496447764807835e-08,6.881123680162443972e-08,4.798744034613024601e-08,6.076567765643298060e-08,9.957366020288527514e-08,1.175578369637339573e-07,9.058155916016953481e-08,3.236958134187274805e-08,4.088841776697204738e-08,8.395580852942826155e-08,7.307064449928877073e-08,5.224685137597655763e-08,2.905672701924830332e-08,5.224684589638849646e-08,6.265874412413554037e-08,5.697952806011816983e-08,2.479730880669865365e-08,6.455182858562062597e-08,7.307064168544627287e-08,6.218547698887047064e-08,6.455181481260189988e-08,4.893397957790896392e-08,8.774194079839696379e-08,6.029240104296155768e-08,7.354390097157158726e-08,3.520920584967000929e-08,9.484099625508363532e-08,6.455182525343864537e-08,4.041514781786447978e-08,6.171221370412675835e-08,6.455181525689280945e-08,6.833796500130466067e-08,5.697953072586373313e-08,4.136168371746132297e-08,3.994187920162964089e-08,7.401718091722499077e-08,3.899533996985092298e-08,2.858345773657704713e-08,7.685679357726420466e-08,4.088842657874208915e-08,4.467456817782021002e-08,6.833794952517076359e-08,6.786469557053646992e-08,5.934586114474642248e-08,5.887259985931185620e-08,6.171221888752095039e-08,3.662901754820492354e-08,6.549835197102300450e-08,6.076567499068741730e-08,3.899534330203279770e-08,6.975778795520967227e-08,4.467456869615958687e-08,3.757554011907395022e-08,5.130032265908305249e-08,4.562109793139257474e-08,5.887260519080298281e-08,3.284286624877483589e-08,3.142307091495563787e-08,5.224685789224347838e-08,1.142449601303694238e-07,-6.438360255765916395e-09,6.218549090998613129e-08,1.107253759610822189e-08,5.461319845576893821e-08,3.378939718712299476e-08,7.685678528383364562e-08,8.158946544825417298e-08,7.307064168544627287e-08,6.455184095171805018e-08,5.508645840833066990e-08,5.366664508072894605e-08,3.000325958666316591e-08,3.331614278819779153e-08,4.514782531653944384e-08,2.574383004469495161e-08,5.792606662546057632e-08,2.385078171887185223e-08,2.101116187612940618e-08,3.284285862178058827e-08,4.325476084814603007e-08,6.265874427223258081e-08,5.130032199264663520e-08,5.130031599471909129e-08,5.887259252851158359e-08,4.136168838251603228e-08,6.076568032217854390e-08,4.230823561153144010e-08,5.130031199610079928e-08,6.502508987105508636e-08,4.940724219621625891e-08,4.609436402997878489e-08,-1.306413650728406898e-08,2.006463597307839891e-08,2.716364122489048901e-08,2.858345255318296097e-08,3.804881340036349842e-08,5.508645892667004675e-08,7.401717358642471816e-08,1.391214262915318815e-08,5.792606129396944971e-08,4.278149652672356408e-08,8.963501859551798231e-08,4.846071629316525164e-08,6.171220555879313388e-08,7.286393479381472280e-09,4.704090178078783952e-08,3.852208135016192001e-08,3.142305410594901207e-08,-1.232422952626155218e-09,7.685680209284027142e-08,4.446785632494008151e-09,4.136168638320688627e-08,4.940724982321050653e-08,3.710228764540942571e-08,3.331614078888864552e-08,5.508645826023362946e-08,3.331613656812484578e-08,6.502509453610990155e-08,4.041515381579191780e-08,5.224685270884928634e-08,4.372802961247780353e-08,2.148442249512755516e-08,3.142305543882174078e-08,7.759667279010397332e-09,4.372805775090309983e-08,2.432405018700965068e-08,3.378939133729249130e-08,2.337752613517085485e-08,4.514783531308527975e-08,4.278150022914788109e-08,3.236959800278243929e-08,-9.277977432762799144e-09,3.899535263214221632e-08,3.026983264068512523e-09,5.413992302707320356e-08,2.763691717192560051e-08,5.697953894524582488e-08,4.940724086334353020e-08,6.786471356431899575e-08,1.911809340911770040e-08,9.058157937540660849e-08,2.527058156964882500e-08,-8.331457675736270337e-09,3.000325225586289329e-08,3.047652220497046090e-08,2.669038460451063204e-08,5.082704004768408567e-08,2.527057690459400981e-08,2.858345521892852427e-08,4.325476766060692583e-08,2.621710947200897828e-08,2.053789325989456729e-08,4.467456869615958687e-08,4.514783864526726035e-08,4.183496447764807835e-08,1.817156587699988353e-08,1.391216684300855384e-08,1.154581569054941396e-08,2.385077905312628893e-08,3.757554678343780553e-08,2.574385951599297663e-08,4.609437417462155537e-08,2.905672324277541315e-08,3.946861539854655176e-08,8.442906514980790675e-08,3.899535596432419692e-08,2.811018378885118752e-08,1.911808874406299109e-08,3.852208283113168917e-08,-2.858878675626638891e-10,3.662902221325963285e-08,4.041516492306508059e-08,5.082705759717559605e-08,2.763691050756163932e-08,4.751416706484069781e-08,3.331613486500967478e-08,1.133913982523454886e-09,2.190511540991045456e-08,1.906550756302299043e-08,3.421008662162697899e-08,5.692694887838731517e-08,1.385956492839210265e-08,2.947740179215174233e-08,3.042394768829431555e-08,3.331612457226986385e-08,5.981914109039982600e-08,2.148444337680104613e-08,3.331612257296071785e-08,5.887260185862100221e-08,1.249233611401236006e-08,3.331613523525211707e-08,6.123894493979498490e-08,2.337749962581226226e-08,3.500257952279256717e-09,5.461319364261718846e-08,1.722502160992401403e-08,5.461318697825333314e-08,3.236961392320735182e-08,2.385079075278729585e-08,3.804882021282428830e-08,1.817155351090245932e-08,5.866580151779854313e-09,9.652734413149374398e-09,4.704090111435142223e-08,3.899535263214221632e-08,1.607178748236830446e-09,2.243097809162209517e-08,5.555972820934130294e-08,2.858345507083158971e-08,3.047652020566131489e-08,4.230821495200335097e-08,5.224685655937064379e-08,2.195769444354426877e-08,3.804880806887237181e-08,4.278149089903846247e-08,1.107254292759934849e-08,-4.072043313707978123e-09,1.438540591389690043e-08,2.053790614433147423e-08,3.946861539854655176e-08,1.911809807417240971e-08,2.385076357699239184e-08,2.574384403985907955e-08,6.606446998521987008e-10,1.959135617552192995e-08,9.179464612138741361e-09,1.769828356179489172e-08,5.130030555388234581e-08,2.905672650090892646e-08,3.142305477238542936e-08,3.047652420427960690e-08,6.597162643708834685e-08,6.339867576330465007e-09,1.485867719587719674e-08,-4.072036797441057369e-09,1.296560806242907367e-08,2.716364322419963502e-08,-5.018578694965444458e-09,5.393320199218016748e-09,2.101115854394742558e-08,1.769829022615885292e-08,3.094979815200557240e-08,1.722502294279674274e-08,3.026982449535160664e-09,3.236960281593418904e-08,2.905673035143028392e-08,2.080448549247463483e-09,3.026983115971577960e-09,2.290423863657177687e-08,4.325475351734575746e-08,2.574383737549522423e-08,5.866584816834563623e-09,1.107254559334491179e-08,5.650626033246525596e-08,4.230822428211287547e-08,3.662901888107765225e-08,4.751417706138653373e-08,1.873660870716297743e-10,2.716365936676994940e-08,-2.110967588152925811e-08,3.236960622216463692e-08,3.047653642228009655e-08,6.813136044468263454e-09,-1.779680519418899127e-08,6.339856765251277232e-09,3.026983115971577960e-09,6.813124048613281531e-09,3.284286943285977604e-08,3.236958467405472865e-08,-7.591738111436113079e-10,1.911809740773599242e-08,2.716364522350878102e-08,3.710228216582136454e-08,1.107253929922339289e-08,2.527058208798820185e-08,3.378939052275913944e-08,1.107253759610822189e-08,3.189633005298401769e-08,3.662900621878625304e-08,7.117756788694344048e-08,6.313201074106123325e-08,1.722501961061486802e-08,-1.637700460292723980e-08,3.973528641871708896e-09,2.148443049236424507e-08,3.473593175384710924e-08,1.249234559221871325e-08,5.866583483961729032e-09,5.413993324576454720e-08,6.606400347974893906e-10,2.905672050298138256e-08,1.391214729420789746e-08,7.286395330593683723e-09,3.662901554889567166e-08,4.656763316455300063e-08,5.130031680925244315e-08,8.706197180679696619e-09,-2.178962998938224985e-09,2.905670835902946608e-08,3.710228905233072758e-08,9.179461798296243494e-09,-2.858836467988641494e-10,-3.104831993249660651e-08,-1.259086455886735537e-08,-1.211758713086247472e-08,-3.010177722043897344e-08,2.080440552010773575e-09,2.669037993945592273e-08,-1.543045863273609342e-08,-3.598775512006596971e-09,3.189632886820822354e-08,-1.211759112948076673e-08,3.284286950690834920e-08,3.804880407025407980e-08,1.769829089259516433e-08,5.508645574258510660e-08,6.813128047231679425e-09,4.467456684494748131e-08,1.012600369582052470e-08,3.142306743467672270e-08,2.432404485551862995e-08,1.769828437632824358e-08,-3.625426804671555547e-08,2.527058156964882500e-08,3.568247365137139045e-08,5.792609557841922448e-08,3.568247987144433619e-08,2.763691583905276592e-08,2.243097253798546084e-08,9.652735894119143553e-09,3.757554411769224223e-08,5.839935056973227185e-08,1.391214062984404214e-08,-1.705703046376493299e-09,1.722504189920955499e-08,-5.018573659668292859e-09,2.669037860658319402e-08,-1.117105737729010999e-08,5.603299830654580510e-08,-2.858898668718098964e-10,1.580522642420185645e-08,2.385078171887185223e-08,1.059927645877069605e-08,1.133905318850347682e-09,3.426268135354019802e-08,3.000327047179082096e-08,2.195770658749629114e-08,2.337751821198273810e-08,1.675175166081644642e-08,-5.491843979018302750e-09,3.284286210205950343e-08,-1.590373406143172219e-08,3.189632005643828766e-08,5.603298616259388862e-08,1.533196180658530957e-08,-4.072036649344122805e-09,1.485868756266547495e-08,3.973518349132003852e-09,1.012600103007496140e-08,5.866590814762001645e-09,6.813124863146633390e-09,1.107254492690849450e-08,-3.598778844188471691e-09,9.652728415221830497e-09,1.133910650341474288e-09,1.391213996340762484e-08,4.704088845206002301e-08,6.813125381486116122e-09,3.568247898286251705e-08,2.952996897802761506e-08,2.574384737204106014e-08,2.811018978677873142e-08,4.183496966104216451e-08,8.706186517697549287e-09,2.290423100957752925e-08,-1.543047011025169849e-08,-2.652245610337191805e-09,5.508646440625810792e-08,2.858344174210377319e-08,5.603300282350357985e-08,1.675176447120478021e-08,-2.726217166905463033e-08,1.722502375733020048e-08,3.973511018331731239e-09,-3.436119024959443107e-08,-1.232427543632397246e-09,6.813122715740552819e-09,4.420129608130645597e-08,1.722501427912374141e-08,1.438540791320604644e-08,1.391216195580844268e-08,3.026985781717035383e-09,1.911809555652378097e-08,3.994189319679376882e-08,3.973510351895313944e-09,1.864482694028904796e-08,5.866584964931498187e-09,1.391214796064420887e-08,1.722502294279674274e-08,1.296559406726494574e-08,-3.767405967811043648e-08,3.000324492506262068e-08,3.852208468234379473e-08,2.101116543045678862e-08,-2.726217500123650505e-08,1.911809888870576157e-08,-1.232420805219968768e-09,-1.448393235944264386e-08,-1.164431999559740498e-08,1.343887801153664127e-08,1.864482360810706736e-08,2.716364722281792703e-08,-1.705693716267074679e-09,-7.591603343188602296e-10,3.236962177234700129e-08,-1.306413717372048628e-08,1.296561006173821968e-08,6.644489453498370301e-08,2.053790458931323780e-08,2.574385470284133276e-08,1.627848770963631684e-08,-2.726217100261821303e-08,6.813123382176864235e-09,-1.827006729415690941e-08,-2.652234799258004030e-09,-1.401066174389865896e-08,1.580522375845629314e-08,7.212411378308611959e-08,1.133914130620389450e-09,-1.590373191402564162e-08,-7.384921776139427148e-09,2.952998897111918101e-08,-5.018575214686529296e-09,3.994189386323018612e-08,4.514782131792115182e-08,-2.773544339532583621e-08,-5.965115927435016359e-09,-1.353738779617279934e-08,1.343887949250641043e-08,1.485869696682336085e-08,1.107253559679907588e-08,1.012600169651137870e-08,1.249233478113963135e-08,6.813122715740552819e-09,-8.804722293352711332e-09,-9.277989576714821510e-09,-3.057504168995847988e-08,5.393320865654434044e-09,6.606408493308412499e-10,1.107253715181731231e-08,1.343889015548866364e-08,5.224684871023099433e-08,3.189632805367487169e-08,-5.965115260998599063e-09,2.053791325298623912e-08,1.607167937157642670e-09,-1.637699867904826906e-08,2.669038082803774187e-08,-2.726216500469066913e-08,1.873694192535044935e-10,-1.069778809461895969e-08,-3.152158188436759009e-08,-4.477308381228687155e-08,1.959136669040714272e-08,6.076568432079683592e-08,2.621711732114862775e-08,6.606428486399872573e-10,1.012601783908169308e-08,-5.965107930198326450e-09,-8.804710297497729409e-09,-2.178961443919988548e-09,6.339864096051549845e-09,-1.401066174389865896e-08,-3.125505562899029370e-09,-1.401066307677149355e-08,-2.016315108920557771e-08,9.652726415912684490e-09,3.500247881684953519e-09,1.864482745862842482e-08,1.580522390655322771e-08,2.148443649029168309e-08,9.179471128405662115e-09,-1.495720764004133806e-08,8.232930711851044180e-09,1.769828422823130901e-08,-1.232432430832508402e-09,2.385077224066539317e-08,1.675176195355615147e-08,-1.232435763014489001e-09,6.813122049304135523e-09,7.286386666920576519e-09,1.012601880171197950e-08,-7.591704789616307095e-10,-5.018573141328810128e-09,1.059927246015229816e-08,6.339846102269024021e-09,9.652729748094665088e-09,-1.705704379249327890e-09,1.201907549501421108e-08,5.866595479816710956e-09,4.446788964675988749e-09,8.706196069952475632e-09,2.952998963755559831e-08,2.080435220519752848e-09,7.759658615337396007e-09,-3.388790630532273553e-08,4.467457336121429618e-08,-2.858938654902077903e-10,-2.252949217107041439e-08,-4.382655990854501028e-08,-2.678891171649279276e-08,2.716364988856349034e-08,-1.306412303045931790e-08,2.080448549247463483e-09,-1.705697048449055277e-09,-6.438374399027084768e-09,-1.705704379249327890e-09,2.148442982592782777e-08,4.562110726150199336e-08,3.426266447048499906e-08,-2.962850608655561169e-08,2.553712648524527626e-09,1.675174433001617381e-08,8.232940041960462800e-09,-1.448392547293328081e-08,-3.672752029823467813e-08,2.101115735917163143e-08,-1.117104804718069137e-08,-1.022451866385076894e-08,1.722502494210599462e-08,-1.448393102656991514e-08,1.864482612575569610e-08,3.899535263214221632e-08,4.446790963985134757e-09,5.887261548354268785e-08,1.959136624611623315e-08,3.615575826207950327e-08,6.813126714358844834e-09,1.580522775707458516e-08,5.130031266253721658e-08,-2.016314975633284899e-08,6.339854099505713929e-09,1.059927445946144417e-08,-1.732355005477900934e-08,3.426267861374616743e-08,1.580521042972847663e-08,-3.125500231407902764e-09,4.798745056482148378e-08,3.899535463145146821e-08,-2.858845353806832907e-10,1.675175514109536159e-08,5.981914575545453531e-08,1.675174366357975652e-08,2.952999119257383474e-08,-8.331449678499580428e-09,1.249234544412177868e-08,2.669036661072821210e-08,-7.591624817249408008e-10,3.142305877100372138e-08,-7.384909780284445225e-09,1.296561139461105427e-08,-1.232429616990010536e-09,3.331612790445184445e-08,2.006462597653256299e-08,1.873767500537771067e-10,-2.158296626801940712e-08,-1.259086189312179207e-08,7.286390813635908977e-09,6.813128269377081270e-09,-2.205622022265370078e-08,-2.584236848609578284e-08,2.716365136953325949e-08,-2.252949069010064523e-08,3.284285728890785956e-08,-1.232437762323635008e-09,-3.104831993249660651e-08,-2.726217300192735904e-08,-2.652236946664190480e-09,2.195770843870839670e-08,4.467456684494748131e-08,1.107254463071451949e-08,1.873707521263390845e-10,-1.232427099341487676e-09,3.946862539509238767e-08,-5.018572030601589141e-09,-1.685027743992587843e-08,2.669037209031627327e-08,-8.331444347008559701e-09,2.053789059414900399e-08,-8.804712963243292712e-09,-9.277984911660112200e-09,-2.652234280918627177e-09,2.290422834383196595e-08,-8.331445013444871118e-09,-1.921661252386317121e-08,-4.072031465950036642e-09,1.107254359403565991e-08,2.148442582730953576e-08,2.290424567117807448e-08,8.706208065807457556e-09,-1.069778342956425038e-08,4.041515248291918909e-08,-1.069780009047394161e-08,2.432404152333664935e-08,-2.063642970198625251e-08,-2.820871023439693094e-08,6.813122863837487383e-09,-2.726217218739400718e-08,-2.584236167363488708e-08,1.873682344777103455e-10,-3.436119824683112098e-08,2.811019111965146013e-08,-1.232432430832508402e-09,-5.965106597325597738e-09,-2.489582925431695906e-08,-3.598769365982118506e-09,-8.331467672282106253e-09,2.337751228810366148e-08,3.189633805022070760e-08,-6.438384543669855248e-09,-2.652238279536919192e-09,-4.545310597070088300e-09,-3.125503563589777483e-09,9.652738411767666413e-09,-4.072040796059455263e-09,2.858348002517183998e-08,8.232929230881275025e-09,-3.341465634930673389e-08,-5.965113928125870351e-09,-8.804714962552438719e-09,2.243096787293075153e-08,1.154579288361524426e-08,4.372803879449028758e-08,1.133902653104784379e-09,1.580521909340158383e-08,-1.259085893118225376e-08,1.769828356179489172e-08,-9.751254194331262506e-09,-1.732353124646313165e-08,1.012599503214752338e-08,2.101116002491719474e-08,-7.591704789616307095e-10,-2.631561777567526132e-08,-4.004039964924794629e-08,2.716365122143632493e-08,6.813119383558572220e-09,-2.652236946664190480e-09,-2.205622755345397339e-08,-2.584237048540492885e-08,-7.591583350097142222e-10,1.769829637218333138e-08,2.574385803502320748e-08,-3.814733784660009583e-08,-2.442255700970627044e-08,-1.637701482161847757e-08,3.500243734969621062e-09,-1.495720482619884020e-08,-1.211758461321395186e-08,6.339866909894047712e-09,3.026984448844306672e-09,2.553719164791448380e-09,-5.491840646836322151e-09,2.337750495730338887e-08,-5.491837981090758848e-09,2.432405300085225442e-08,9.652741892046581575e-09,-1.232440428069198311e-09,-6.911637831867731616e-09,-2.252948484027014177e-08,-1.732354938834259204e-08,-1.164432799283409489e-08,-2.178967515895999731e-09,1.873680863807757817e-10,-3.598776178442908388e-09,-2.205622155552642949e-08,-2.858898668718098964e-10,4.514784197744913507e-08,2.101116654118411549e-08,3.026973119425742044e-09,6.813124715049698826e-09,5.393320199218016748e-09,-1.637699816070878633e-08,-1.211758261390469997e-08,2.080444698726106032e-09,1.911808874406299109e-08,-1.069779809116479560e-08,1.391214862708062617e-08,1.769829585384384865e-08,1.722502294279674274e-08,2.290423900681411328e-08,1.485868067615611191e-08,-1.069778009738226978e-08,1.438540791320604644e-08,-4.004040631361180161e-08,1.627849304112744345e-08,-2.868198151637733313e-08,-9.751261525131535119e-09,-1.211759246235360132e-08,-2.820870075619057776e-08,-2.063641970544041659e-08,-2.631563510302136985e-08,-2.858985305449171006e-10,2.290423300888667526e-08,-1.164432799283409489e-08,-7.591711453980480050e-10,-1.968988447227988482e-08,-1.874334590693758421e-08,3.520921436524607606e-08,-8.804714148019086860e-09,1.107254026185378519e-08,-2.489582910622002449e-08,-9.277988243841986919e-09,3.973523828720065022e-09,6.339855432378548520e-09,-1.022453080780268543e-08,-1.448392436220595395e-08,-1.211758698276554015e-08,1.911810155445132487e-08,2.101117535295415726e-08,-1.117104804718069137e-08,-8.331456342863541625e-09,-1.401066507608063956e-08,-4.072048126859727876e-09,3.500254397951874273e-09,-1.827007995644830862e-08,4.920054915165158457e-09,3.026995259923494447e-09,3.757554411769224223e-08,3.331613567954302664e-08,2.006462197791427098e-08,-1.259085589519424817e-08,1.722502575663934648e-08,-4.997903725799684123e-08,-3.057504383736456045e-08,8.706196514243385203e-09,3.094978215753229846e-08,-1.495719564418635614e-08,-5.897112697129401692e-08,-3.294138773307200088e-08,7.759659948210124719e-09,2.080446549938317476e-09,-2.726217166905463033e-08,2.952998030744617969e-08,-5.965099932961742420e-09,3.026975785171305346e-09,-3.530772800040348570e-08,-1.448393702449735317e-08,-1.259085589519424817e-08,1.675174299714333922e-08,1.154580821165220678e-08,-2.178973661920478196e-09,-1.921661119099044250e-08,9.179459798987097487e-09,-4.808597345603984476e-08,1.769828504276466087e-08,3.284286543424148403e-08,-7.591684796524847021e-10,6.339849434451004619e-09,-4.335327848192183761e-08,4.940725633947742728e-08,1.864482012782815220e-08,-1.259085456232151946e-08,1.607184820212841629e-09,3.520920799707608987e-08,-1.921660637783869275e-08,-2.820870623577863893e-08,3.520919103997242363e-08,-4.477307581505018164e-08,3.973519163665355712e-09,-2.158294494205500657e-08,2.574385618381110191e-08,6.606480320341792992e-10,-2.678890771787450075e-08,-8.331444347008559701e-09,-2.773544428390776123e-08,-2.158295093998244459e-08,-1.637700800915768768e-08,-6.843648863300790623e-08,-5.965109263071161041e-09,2.527057475718792924e-08,6.339853433069296634e-09,-2.158295960365555180e-08,1.533194981073032765e-08,-2.016314442484172239e-08,1.201907216283223048e-08,-1.685026248213135820e-08,-4.382654458050804776e-08,4.325476484676442797e-08,-3.388790749009852968e-08,-5.018583360020153769e-09,5.393326197145560650e-09,-5.965107263762015033e-09,-1.117105337867181798e-08,-8.331443014135725110e-09,1.607177415364101734e-09,3.500264764740152478e-09,6.606347033063627848e-10,-3.125507562208175377e-09,1.873620884532318804e-10,1.911809474199042911e-08,4.420130089445820572e-08,1.296560539668351037e-08,1.154581665317980626e-08,-2.394929135541096986e-08,-2.652236280227773185e-09,6.813127380795262129e-09,-7.591591495430660816e-10,-7.591624817249408008e-10,7.286402661393956336e-09,1.438541790975188235e-08,1.769829422477714493e-08,-2.110968299018412888e-08,-1.732354938834259204e-08,5.393316867036142029e-09,-1.921660785880846190e-08,-2.347603073641282088e-08,2.243097305632494358e-08,1.675175632587115573e-08,9.652734413149374398e-09,-2.178966331120205583e-09,-1.401066626085643371e-08,-1.259085907927918832e-08,-1.685027277487106324e-08,-1.968987566050994893e-08,1.391214796064420887e-08,5.393327530018289361e-09,1.722502094348759673e-08,-1.401066507608063956e-08,2.553713314960944922e-09,4.920063800983667507e-09,1.580521842696516654e-08,2.243097372276125499e-08,2.527058356895797101e-08,1.627848770963631684e-08,-1.448393569162462445e-08,-1.921661918822702653e-08,2.006462397722341698e-08,-1.401067040757176616e-08,-1.705705712122056602e-09,-1.590373221021951074e-08,-3.125504896462612074e-09,1.607177267267167170e-09,-1.211759394332337048e-08,6.606446998521987008e-10,-6.438382544360709241e-09,7.286393331284537716e-09,2.858345388605579556e-08,1.873687528171930772e-10,-3.125504230026194779e-09,8.706199994522300365e-09,2.858345507083158971e-08,1.533194447923920104e-08,-2.016315775356943302e-08,4.446780967439298841e-09,-1.590375286974759987e-08,-1.495719142342255640e-08,1.911809688939661556e-08,-2.858965312356652141e-10,2.080445883501900180e-09,-3.104830727020531317e-08,-1.022451266592322504e-08,-2.584236315460465624e-08,-2.110968565592958630e-08,5.508646492459759065e-08,-2.726217166905463033e-08,1.391214744230483202e-08,-2.178961517968561709e-09,-1.306412191973199104e-08,-2.063641903900399930e-08,-1.117105922850232144e-08,-5.965109114974226477e-09,-4.051367878036799795e-08,6.339854765942131225e-09,-2.178961666065496273e-09,6.644489505332318574e-08,-3.909386426799047996e-08,-1.705696382012637982e-09,1.607171935776040564e-09,-5.965097785555555970e-09,1.817156217457556652e-08,-3.862060579639851743e-08,8.232929897317692321e-09,2.527058623470353431e-08,6.606480320341792992e-10,2.290423182411088111e-08,2.385077757215651977e-08,2.290424115422029973e-08,5.393320199218016748e-09,5.555972687646846835e-08,-9.751248862840135900e-09,5.393323013060620494e-09,1.485868186093190605e-08,1.438540991251519245e-08,-3.199483917118375847e-08,3.331613604978546893e-08,5.866594146943982244e-09,6.339875647615622198e-09,7.286387999793411110e-09,5.866586816143709631e-09,-3.598773512697450964e-09,-2.536909972176390351e-08,3.973520496538084424e-09,3.378939600234720061e-08,-7.384902301387238048e-09,6.339864244148484409e-09,2.553711389700266196e-09,-2.442256115642160290e-08,-4.477308433062624840e-08,9.652731080967393800e-09,1.201907216283223048e-08,9.179466463350952804e-09,9.179469795532827524e-09,9.652735746022103110e-09,-3.483446619662954257e-08,1.873794157993404096e-10,1.059926897987338300e-08,-1.117106737383594591e-08,-2.489582992075337635e-08,-5.018590690820426382e-09,-1.685027410774389783e-08,-4.051366389662194500e-08,-3.341465968148871448e-08,-2.178967663993040174e-09,4.920048250801303139e-09,-2.773543147351942745e-08,-2.442256197095495476e-08,8.706195847806967907e-09,-1.232427099341487676e-09,9.652726415912684490e-09,-3.530772200247594180e-08,-2.820869957141478361e-08,1.012599303283837737e-08,1.817155684308443992e-08,1.769829022615885292e-08,2.905672065107831713e-08,-2.178964035617084569e-09,-2.158296027009196909e-08,2.243097905425238160e-08,-1.211759794194166249e-08,-1.353739712628221796e-08,-2.858865346899351772e-10,-1.353740845570078259e-08,8.232925232262983010e-09,1.580520709754660191e-08,-1.306412984292021366e-08,2.053791258654982183e-08,1.873727514354850919e-10,-3.814733451441811524e-08,-7.858187060192285440e-09,-2.858892004353926009e-10,-1.353739031382132220e-08,-3.125493937286489735e-09,-3.625426937958839006e-08,9.652738411767666413e-09,-1.448392221479987338e-08,-1.779681067377715832e-08,-1.117104982434443553e-08,-6.438384395572814805e-09,9.652727082349101785e-09,8.232930563754109616e-09,-1.022448519393434603e-08,1.817158024240655963e-08,2.669038527094704934e-08,-2.300276545235996259e-08,-7.384911779593591232e-09,-3.104829890272618098e-08,1.675175899161671904e-08,3.026987262686804538e-09,-1.211759527619609919e-08,-1.543046492685750645e-08,5.866582817525417616e-09,4.514783064803057044e-08,-2.584237248471407486e-08,-8.331445679881288413e-09,3.284286128752615157e-08,3.284287528269038538e-08,1.911809007693571980e-08,-2.584236115529551023e-08,1.580521309547403993e-08,5.413992584091580731e-08,1.391215210735954133e-08,2.858346254972879689e-08,8.706195181370550612e-09,-6.438384543669855248e-09,8.706197180679696619e-09,9.652728415221830497e-09,-1.779680400941319712e-08,-2.726217033618179574e-08,1.817156165623618967e-08,1.627848704320000543e-08,-5.491848644073012060e-09,-9.751257526513243104e-09,5.393324197836414642e-09,-1.117105056482921423e-08,1.107253826254463918e-08,-8.804719479510213466e-09,-2.536909705601844609e-08,-2.915524280181189941e-08,-2.631562710578467994e-08,-8.804718961170836613e-09,-5.491838647527176144e-09,2.148444781971024772e-08,6.339862096742403838e-09,-1.306412917648379637e-08,4.920045585055739837e-09,1.201908763896612757e-08,2.669037194221923283e-08,7.759671499774197072e-09,-2.820870357003307562e-08,2.006463264089641831e-08,-2.631563910163966186e-08,1.627848171170887882e-08,-1.827006640557509026e-08,-2.652236798567255916e-09,1.296561672610218088e-08,-1.921659689963233956e-08,1.959136624611623315e-08,1.107253774420515645e-08,2.716363322765379910e-08,2.080451363089961350e-09,-2.300276197208104743e-08,-1.495720030924106545e-08,2.621713975784035516e-08,8.706210805601488140e-09,1.873767500537771067e-10,2.290424167255967659e-08,6.606503275373003134e-10,1.343893769461768176e-08,3.973514350513605959e-09,-1.685027544061662655e-08,-2.252948528456105135e-08,1.873916337998300579e-10]


# ---------- calculation and plots ------------

fig,ax = py.subplots(facecolor='white')
py.step([x+1 for x in range(3564)],bxraw_reprocessed_tot,where='mid', alpha = 0.8)#label = 'reprocessed with no albedo correction')
py.xlabel('BCID')
py.ylabel('bxraw summed')
py.title('total bxraw vs bcid')
#py.yscale('log')
#py.legend()


# calculate albedo correction
correction = []
correction_orig_channel =[]
single_bunch = 1786 # bcid of a single bunch
bunch = 1786 # going to go through empty bunches after single bunch
while bunch < 3564:
    correction.append((bxraw_reprocessed_tot[bunch - 1]) / (bxraw_reprocessed_tot[single_bunch - 1]))
    correction_orig_channel.append((bxraw_reprocessed_tot_orig_channel[bunch - 1]) / (bxraw_reprocessed_tot_orig_channel[single_bunch - 1]))
    bunch += 1
correction = correction[:1747]
correction_orig_channel = correction_orig_channel[:1747]

#(plotting before baseline subtraction)
fig,ax = py.subplots(facecolor='white')
py.step([x for x in range(len(correction))],correction,where='mid',alpha =0.5, label = 'calculated albedo model with baseline', color = 'orange')
py.step([x for x in range(len(correction_orig_channel))],correction_orig_channel,where='mid',alpha =0.5, label = 'original untuned albedo model with baseline', color = 'blue')
py.title('albedo model comparison')
py.yscale('log')
py.legend()


baseline = mean(correction[1200:]) # subtracting the baseline from the correction
baseline_orig_channel = mean(correction_orig_channel[1200:])
correction = [x-baseline for x in correction]
correction_orig_channel = [x-baseline_orig_channel for x in correction_orig_channel]
correction[0]=1.0 # setting the first element in the model to exactly 1.0
correction_orig_channel[0] = 1.0

print('calculated albedo model for the NEW CHANNEL MASK: \nalbedo_model = ',correction)
print('it had baseline:', baseline)

print('calculated albedo model for the ORIGINAL CHANNEL MASK: \nalbedo_model = ',correction_orig_channel)
print('it had baseline:', baseline_orig_channel)

fig,ax = py.subplots(facecolor='white')
py.step([x for x in range(len(correction))],correction,where='mid',alpha = 0.8,label = 'new channels albedo model',color = 'orange')
py.step([x for x in range(len(albedo_model_moritz))],albedo_model_moritz,where='mid',alpha =0.8, label = 'original channels tuned albedo model', color = 'red')
py.step([x for x in range(len(correction_orig_channel))],correction_orig_channel,where='mid',alpha =0.8, label = 'original channels untuned albedo model', color = 'blue')
py.title('albedo model comparison')
py.yscale('log')
py.legend()

py.show()
